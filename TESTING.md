# CyberEdge æµ‹è¯•æŒ‡å—

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜äº† CyberEdge å®‰å…¨æ‰«æå¹³å°çš„æµ‹è¯•æ¶æ„å’Œè¦†ç›–ç‡é…ç½®ã€‚

## æµ‹è¯•æ¶æ„æ¦‚è§ˆ

CyberEdge é‡‡ç”¨å¤šå±‚æµ‹è¯•ç­–ç•¥ï¼š

```
ğŸ“Š æµ‹è¯•é‡‘å­—å¡”
â”œâ”€â”€ ğŸ”¬ å•å…ƒæµ‹è¯• (Unit Tests)
â”‚   â”œâ”€â”€ å‰ç«¯ç»„ä»¶æµ‹è¯• (Vue.js + Vitest)
â”‚   â””â”€â”€ åç«¯å‡½æ•°æµ‹è¯• (Go + testing)
â”œâ”€â”€ ğŸ”— é›†æˆæµ‹è¯• (Integration Tests)
â”‚   â”œâ”€â”€ API æ¥å£æµ‹è¯•
â”‚   â””â”€â”€ æ•°æ®åº“äº¤äº’æµ‹è¯•
â””â”€â”€ ğŸŒ ç«¯åˆ°ç«¯æµ‹è¯• (E2E Tests)
    â””â”€â”€ ç”¨æˆ·æµç¨‹æµ‹è¯• (Playwright)
```

## å¿«é€Ÿå¼€å§‹

### è¿è¡Œæ‰€æœ‰æµ‹è¯•
```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
./run-all-tests.sh

# è¿è¡Œç‰¹å®šç±»å‹çš„æµ‹è¯•
./run-all-tests.sh frontend  # ä»…å‰ç«¯æµ‹è¯•
./run-all-tests.sh backend   # ä»…åç«¯æµ‹è¯•
./run-all-tests.sh e2e       # ä»…E2Eæµ‹è¯•
```

## å‰ç«¯æµ‹è¯•

### æŠ€æœ¯æ ˆ
- **æµ‹è¯•æ¡†æ¶**: Vitest
- **è¦†ç›–ç‡å·¥å…·**: @vitest/coverage-v8
- **ç»„ä»¶æµ‹è¯•**: @vue/test-utils
- **æ¨¡æ‹Ÿå·¥å…·**: å†…ç½® vi.mock()

### è¿è¡Œå‰ç«¯æµ‹è¯•
```bash
cd frontend

# è¿è¡Œæµ‹è¯•
npm run test

# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage

# åœ¨UIæ¨¡å¼ä¸‹è¿è¡Œæµ‹è¯•
npm run test:coverage:ui
```

### è¦†ç›–ç‡ç›®æ ‡
- **è¡Œè¦†ç›–ç‡**: â‰¥ 70%
- **å‡½æ•°è¦†ç›–ç‡**: â‰¥ 70%
- **åˆ†æ”¯è¦†ç›–ç‡**: â‰¥ 60%
- **è¯­å¥è¦†ç›–ç‡**: â‰¥ 70%

### æµ‹è¯•æ–‡ä»¶ç»“æ„
```
frontend/src/
â”œâ”€â”€ components/
â”‚   â””â”€â”€ __tests__/          # ç»„ä»¶å•å…ƒæµ‹è¯•
â”œâ”€â”€ views/
â”‚   â””â”€â”€ __tests__/          # é¡µé¢ç»„ä»¶æµ‹è¯•
â”œâ”€â”€ store/
â”‚   â””â”€â”€ __tests__/          # çŠ¶æ€ç®¡ç†æµ‹è¯•
â””â”€â”€ tests/
    â””â”€â”€ setup.js            # æµ‹è¯•ç¯å¢ƒé…ç½®
```

## åç«¯æµ‹è¯•

### æŠ€æœ¯æ ˆ
- **æµ‹è¯•æ¡†æ¶**: Go æ ‡å‡† testing åŒ…
- **è¦†ç›–ç‡å·¥å…·**: go tool cover
- **HTTPæµ‹è¯•**: httptest åŒ…
- **æ•°æ®åº“æµ‹è¯•**: å†…å­˜SQLite/æµ‹è¯•MySQL

### è¿è¡Œåç«¯æµ‹è¯•
```bash
cd backend

# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
./test-all.sh

# æ‰‹åŠ¨è¿è¡Œæµ‹è¯•
go test -v -race -coverprofile=coverage/coverage.out ./...

# ç”ŸæˆHTMLè¦†ç›–ç‡æŠ¥å‘Š
go tool cover -html=coverage/coverage.out -o coverage/coverage.html
```

### è¦†ç›–ç‡ç›®æ ‡
- **æ€»ä½“è¦†ç›–ç‡**: â‰¥ 70%

### æµ‹è¯•æ–‡ä»¶ç»“æ„
```
backend/
â”œâ”€â”€ pkg/
â”‚   â”œâ”€â”€ api/handlers/
â”‚   â”‚   â””â”€â”€ *_test.go       # APIå¤„ç†å™¨æµ‹è¯•
â”‚   â”œâ”€â”€ service/
â”‚   â”‚   â””â”€â”€ *_test.go       # ä¸šåŠ¡é€»è¾‘æµ‹è¯•
â”‚   â””â”€â”€ dao/
â”‚       â””â”€â”€ *_test.go       # æ•°æ®è®¿é—®æµ‹è¯•
â””â”€â”€ tests/
    â””â”€â”€ integration/        # é›†æˆæµ‹è¯•
```

## ç«¯åˆ°ç«¯æµ‹è¯•

### æŠ€æœ¯æ ˆ
- **E2Eæ¡†æ¶**: Playwright
- **æµè§ˆå™¨**: Chromium, Firefox, WebKit
- **æµ‹è¯•ç¯å¢ƒ**: è‡ªåŠ¨å¯åŠ¨å¼€å‘æœåŠ¡å™¨

### è¿è¡ŒE2Eæµ‹è¯•
```bash
cd frontend

# å®‰è£…æµè§ˆå™¨
npx playwright install

# è¿è¡ŒE2Eæµ‹è¯•
npm run test:e2e

# åœ¨UIæ¨¡å¼ä¸‹è¿è¡Œ
npm run test:e2e:ui

# æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Š
npm run test:e2e:report
```

### æµ‹è¯•åœºæ™¯
- âœ… ç”¨æˆ·è®¤è¯ (ç™»å½•/æ³¨å†Œ/2FA)
- âœ… ä»ªè¡¨æ¿åŠŸèƒ½
- âœ… æ‰«æåŠŸèƒ½ (ç«¯å£æ‰«æ/å­åŸŸåæ‰«æ)
- âœ… è®¾ç½®ç®¡ç†
- âœ… ç”¨æˆ·ç®¡ç† (ç®¡ç†å‘˜åŠŸèƒ½)

### E2Eæµ‹è¯•æ–‡ä»¶
```
frontend/e2e/
â”œâ”€â”€ auth.spec.js            # è®¤è¯æµç¨‹æµ‹è¯•
â”œâ”€â”€ dashboard.spec.js       # ä»ªè¡¨æ¿æµ‹è¯•
â”œâ”€â”€ scanning.spec.js        # æ‰«æåŠŸèƒ½æµ‹è¯•
â””â”€â”€ settings.spec.js        # è®¾ç½®é¡µé¢æµ‹è¯•
```

## è¦†ç›–ç‡æŠ¥å‘Š

### æŸ¥çœ‹è¦†ç›–ç‡æŠ¥å‘Š

**å‰ç«¯è¦†ç›–ç‡**:
```bash
# ç”Ÿæˆå¹¶æ‰“å¼€HTMLæŠ¥å‘Š
cd frontend && npm run test:coverage
open coverage/index.html
```

**åç«¯è¦†ç›–ç‡**:
```bash
# ç”Ÿæˆå¹¶æ‰“å¼€HTMLæŠ¥å‘Š
cd backend && ./test-all.sh
open coverage/coverage.html
```

**E2Eæµ‹è¯•æŠ¥å‘Š**:
```bash
# æŸ¥çœ‹E2Eæµ‹è¯•æŠ¥å‘Š
cd frontend && npm run test:e2e:report
```

### è¦†ç›–ç‡é…ç½®

è¦†ç›–ç‡é…ç½®åœ¨ä»¥ä¸‹æ–‡ä»¶ä¸­å®šä¹‰ï¼š
- `frontend/vitest.config.js` - å‰ç«¯è¦†ç›–ç‡é…ç½®
- `backend/test-all.sh` - åç«¯è¦†ç›–ç‡é…ç½®
- `test-config.json` - ç»Ÿä¸€æµ‹è¯•é…ç½®

## æŒç»­é›†æˆ

### CI æµæ°´çº¿
```yaml
# ç¤ºä¾‹ CI é…ç½®
stages:
  - dependencies
  - test-frontend
  - test-backend
  - test-e2e
  - coverage-report

# è¦†ç›–ç‡é˜ˆå€¼æ£€æŸ¥
coverage-check:
  - å‰ç«¯è¦†ç›–ç‡ â‰¥ 70%
  - åç«¯è¦†ç›–ç‡ â‰¥ 70%
  - å¤±è´¥æ—¶é€€å‡ºæ„å»º
```

## æœ€ä½³å®è·µ

### ç¼–å†™æµ‹è¯•çš„åŸåˆ™
1. **å•ä¸€èŒè´£**: æ¯ä¸ªæµ‹è¯•åªéªŒè¯ä¸€ä¸ªåŠŸèƒ½ç‚¹
2. **ç‹¬ç«‹æ€§**: æµ‹è¯•ä¹‹é—´ä¸åº”ç›¸äº’ä¾èµ–
3. **å¯é‡å¤æ€§**: æµ‹è¯•ç»“æœåº”è¯¥ä¸€è‡´å’Œå¯é¢„æµ‹
4. **æ¸…æ™°å‘½å**: æµ‹è¯•åç§°åº”è¯¥æè¿°æµ‹è¯•çš„å†…å®¹

### å‰ç«¯æµ‹è¯•æœ€ä½³å®è·µ
- ä½¿ç”¨ `data-testid` è€Œé CSS ç±»åå®šä½å…ƒç´ 
- æ¨¡æ‹Ÿå¤–éƒ¨ä¾èµ– (APIè°ƒç”¨ã€ç¬¬ä¸‰æ–¹åº“)
- æµ‹è¯•ç”¨æˆ·äº¤äº’è€Œéå®ç°ç»†èŠ‚
- ä¿æŒæµ‹è¯•ç®€å•å’Œå¯è¯»

### åç«¯æµ‹è¯•æœ€ä½³å®è·µ
- ä½¿ç”¨è¡¨é©±åŠ¨æµ‹è¯•å¤„ç†å¤šç§è¾“å…¥
- æµ‹è¯•é”™è¯¯è·¯å¾„å’Œè¾¹ç•Œæ¡ä»¶
- ä½¿ç”¨æµ‹è¯•æ•°æ®åº“é¿å…æ±¡æŸ“ç”Ÿäº§æ•°æ®
- æ¸…ç†æµ‹è¯•äº§ç”Ÿçš„å‰¯ä½œç”¨

### E2Eæµ‹è¯•æœ€ä½³å®è·µ
- æµ‹è¯•å…³é”®ç”¨æˆ·æµç¨‹
- ä½¿ç”¨é¡µé¢å¯¹è±¡æ¨¡å¼ (Page Object Pattern)
- é¿å…æµ‹è¯•å®ç°ç»†èŠ‚
- åˆç†ä½¿ç”¨ç­‰å¾…å’Œé‡è¯•æœºåˆ¶

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**å‰ç«¯æµ‹è¯•å¤±è´¥**:
```bash
# æ¸…ç†ä¾èµ–é‡æ–°å®‰è£…
cd frontend && rm -rf node_modules && npm install

# æ›´æ–°å¿«ç…§
npm run test -- --update-snapshots
```

**åç«¯æµ‹è¯•å¤±è´¥**:
```bash
# æ£€æŸ¥Goç‰ˆæœ¬
go version

# æ›´æ–°ä¾èµ–
go mod tidy && go mod download
```

**E2Eæµ‹è¯•å¤±è´¥**:
```bash
# é‡æ–°å®‰è£…æµè§ˆå™¨
npx playwright install

# æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦è¿è¡Œ
curl http://localhost:8080
```

## è´¡çŒ®æŒ‡å—

### æ·»åŠ æ–°æµ‹è¯•
1. åœ¨ç›¸åº”ç›®å½•åˆ›å»ºæµ‹è¯•æ–‡ä»¶
2. éµå¾ªç°æœ‰çš„å‘½åçº¦å®š
3. ç¡®ä¿æµ‹è¯•é€šè¿‡ä¸”è¦†ç›–ç‡æ»¡è¶³è¦æ±‚
4. æ›´æ–°ç›¸å…³æ–‡æ¡£

### ä»£ç æäº¤å‰æ£€æŸ¥
```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
./run-all-tests.sh

# æ£€æŸ¥ä»£ç é£æ ¼
cd frontend && npm run lint
cd backend && go fmt ./...
```

---

ğŸ“Š **å½“å‰æµ‹è¯•çŠ¶æ€**
- âœ… å‰ç«¯å•å…ƒæµ‹è¯•: 26 ä¸ªæµ‹è¯•ç”¨ä¾‹
- âœ… åç«¯é›†æˆæµ‹è¯•: å®Œæ•´APIæµ‹è¯•è¦†ç›–
- âœ… E2Eæµ‹è¯•: 4ä¸ªä¸»è¦åŠŸèƒ½æ¨¡å—
- âœ… è¦†ç›–ç‡é…ç½®: å‰ç«¯+åç«¯ç»Ÿä¸€é…ç½®

æ›´å¤šä¿¡æ¯è¯·å‚è€ƒå„æµ‹è¯•ç›®å½•ä¸­çš„ README æ–‡ä»¶ã€‚