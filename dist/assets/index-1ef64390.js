import{n as l,c as a}from"./index-00af24fc.js";var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("t-form",{ref:"form",attrs:{data:t.formData,rules:t.rules},on:{submit:t.onSubmit}},[r("t-form-item",{attrs:{label:"字典文件",name:"wordlist"}},[r("t-cascader",{attrs:{options:t.wordlistOptions,placeholder:"请选择字典文件",clearable:""},model:{value:t.formData.wordlist,callback:function(s){t.$set(t.formData,"wordlist",s)},expression:"formData.wordlist"}})],1),r("t-form-item",{attrs:{label:"URL",name:"url",help:"URL格式：http://127.0.0.1:8000/FUZZ"}},[r("t-input",{attrs:{placeholder:"请输入URL"},model:{value:t.formData.url,callback:function(s){t.$set(t.formData,"url",s)},expression:"formData.url"}})],1),r("t-form-item",{staticStyle:{"margin-left":"100px"}},[r("t-space",{attrs:{size:"10px"}},[r("t-button",{attrs:{theme:"primary",type:"submit",ghost:""}},[t._v("提交")])],1)],1)],1)},i=[];const u={data(){return{formData:{wordlist:null,url:""},wordlistOptions:[],rules:{wordlist:[{required:!0,message:"字典文件必选",type:"error"}],url:[{required:!0,message:"URL必填",type:"error"},{validator:this.urlValidator,message:"无效的URL"}]}}},mounted(){this.fetchWordlistOptions()},methods:{fetchWordlistOptions(){this.$request.get("/api/path_scanner/wordlist").then(t=>{this.wordlistOptions=t.data.files.map(e=>({value:e.path,label:e.name,children:null}))}).catch(t=>{console.error("获取字典文件选项失败:",t),a.error("无法加载字典文件列表")})},urlValidator(t){return/^(https?:\/\/)?((www\.)?([a-z0-9]+([-\.]{1}[a-z0-9]+)*\.[a-z]{2,5})|(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}))(:\d{1,5})?(\/.*)?$/.test(t)},onSubmit({validateResult:t}){if(t===!0){const e={wordlist:this.formData.wordlist,urls:[this.formData.url]};this.$request.post("/api/path_scanner/scan",e,{headers:{"Content-Type":"application/json"}}).then(r=>{a.success("路径扫描任务提交成功")}).catch(r=>{a.error("路径扫描任务提交失败")})}else a.warning("表单验证失败，请检查输入")}}},o={};var c=l(u,n,i,!1,d,"b76e6bda",null,null);function d(t){for(let e in o)this[e]=o[e]}const p=function(){return c.exports}();export{p as default};
