import{n as m,c as p}from"./index-8fffec42.js";var c=function(){var t=this,r=t.$createElement,e=t._self._c||r;return e("t-form",{ref:"form",attrs:{data:t.formData,rules:t.rules},on:{submit:t.onSubmit}},[e("t-form-item",{attrs:{label:"IP地址",name:"ip"}},[e("t-input",{attrs:{placeholder:"请输入IP地址"},model:{value:t.formData.ip,callback:function(s){t.$set(t.formData,"ip",s)},expression:"formData.ip"}})],1),e("t-form-item",{attrs:{label:"端口",name:"port",help:"端口范围: 1-65535"}},[e("t-input",{attrs:{placeholder:"请输入端口"},model:{value:t.formData.port,callback:function(s){t.$set(t.formData,"port",s)},expression:"formData.port"}})],1),e("t-form-item",{staticStyle:{"margin-left":"100px"}},[e("t-space",{attrs:{size:"10px"}},[e("t-button",{attrs:{theme:"primary",type:"submit",ghost:""}},[t._v("提交")])],1)],1)],1)},u=[];const f={data(){return{formData:{ip:"",port:""},rules:{ip:[{required:!0,message:"IP地址必填",type:"error"},{validator:this.ipValidator,message:"无效的IP地址"}],port:[{required:!0,message:"端口必填",type:"error"},{validator:this.portValidator,message:"无效的端口号"}]}}},methods:{onSubmit({validateResult:t}){if(t===!0){const r={target:this.formData.ip,ports:this.formData.port};this.$request.post("/api/port_scanner/scan",r,{headers:{"Content-Type":"application/json"}}).then(e=>{p.success("端口扫描任务提交成功")}).catch(e=>{p.error("端口扫描任务提交失败")})}else p.warning("表单验证失败，请检查输入")},ipValidator(t){return/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(t)},portValidator(t){const s=t.split(",");for(let o of s)if(o.includes("-")){const a=o.split("-");if(a.length!==2)return!1;const n=parseInt(a[0],10),i=parseInt(a[1],10);if(isNaN(n)||isNaN(i)||n<1||i>65535||n>i)return!1}else{const a=parseInt(o,10);if(isNaN(a)||a<1||a>65535)return!1}return!0}}},l={};var _=m(f,c,u,!1,d,"1ed91bb0",null,null);function d(t){for(let r in l)this[r]=l[r]}const v=function(){return _.exports}();export{v as default};
